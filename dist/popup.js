document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("mainButton"),t=document.getElementById("savedLinks"),n=document.getElementById("groupList"),o=JSON.parse(localStorage.getItem("groups"))||[];let l=JSON.parse(localStorage.getItem("openGroups"))||[];const d=document.getElementById("myModal"),a=document.getElementById("closeModal"),i=document.getElementById("saveButton"),s=document.getElementById("title"),c=document.getElementById("url"),r=document.getElementById("group");function p(e,t,n){const l=JSON.parse(localStorage.getItem("savedLinks"))||[];l.push({title:e,url:t,group:n}),localStorage.setItem("savedLinks",JSON.stringify(l)),n&&!o.includes(n)&&(o.push(n),localStorage.setItem("groups",JSON.stringify(o)),m(n))}function u(){t.innerHTML="";const e=JSON.parse(localStorage.getItem("savedLinks"))||[];if(0===e.length){const e=document.createElement("p");e.textContent="Нет сохраненных записей.",t.appendChild(e)}else e.forEach(((e,n)=>{if(!l.includes(e.group))return;const d=document.createElement("li"),a=document.createElement("p"),i=document.createElement("button"),s=document.createElement("button"),c=document.createElement("button"),r=document.createElement("div");c.classList.add("go-link-button"),c.textContent="Go",d.addEventListener("click",(t=>{return n=e.url,void window.open(n,"_blank");var n})),s.classList.add("copy-link-button"),s.textContent="Copy",s.addEventListener("click",(t=>function(e,t){e.stopPropagation();const n=document.createElement("div"),o=document.createElement("p");o.classList.add("alert__text"),n.classList.add("alert_hide"),navigator.clipboard.writeText(t).then((()=>{o.textContent="Успешно скопировано",n.classList.replace("alert_hide","alert_show"),n.appendChild(o),document.body.appendChild(n)})).catch((e=>{o.textContent="Ошибка",n.classList.replace("alert_hide","alert_show"),n.appendChild(o),document.body.appendChild(n)})).finally((()=>{setTimeout((()=>{n.classList.replace("alert_show","alert_hide")}),1e3)}))}(t,e.url))),i.classList.add("delete-button"),i.textContent="Delete",i.addEventListener("click",(e=>function(e,t){e.stopPropagation();const n=JSON.parse(localStorage.getItem("savedLinks"))||[],l=n.splice(t,1)[0];localStorage.setItem("savedLinks",JSON.stringify(n)),l.group&&n.every((e=>e.group!==l.group))&&(o.splice(o.indexOf(l.group),1),localStorage.setItem("groups",JSON.stringify(o))),u()}(e,n))),a.textContent=`${e.title}`,a.classList.add("title"),d.appendChild(a),r.appendChild(c),r.appendChild(s),r.appendChild(i),d.appendChild(r),t.appendChild(d)}));n.innerHTML="<div>Фильтр категорий:</div>",o.forEach((e=>{const t=document.createElement("div");t.classList.add("group-item"),l.includes(e)&&t.classList.add("active"),t.textContent=e,t.addEventListener("click",(()=>m(e))),n.appendChild(t)}))}function m(e){l.includes(e)?l=l.filter((t=>t!==e)):l.push(e),localStorage.setItem("openGroups",JSON.stringify(l)),u()}e.addEventListener("click",(function(){d.style.display="block"})),a.addEventListener("click",(function(){d.style.display="none"})),i.addEventListener("click",(function(){const e=s.value.trim(),t=c.value.trim(),n=r.value.trim()||"Без категории";e&&t&&(p(e,t,n),u(),d.style.display="none")})),e.addEventListener("click",(function(){let e=prompt("Краткое описание:");for(;!e;)e=prompt("Описание не введено, повторите:");let t=prompt("Введите URL:");for(;!/^(ftp|http|https):\/\/[^ "]+$/.test(t);)t=prompt("Введен некорректный URL, введите корректный URL:");const n=prompt("Введите название группы, в которую будет входить ссылка (не обязательно):")||"Без категории";e&&t&&(p(e,t,n),u())})),u()}));